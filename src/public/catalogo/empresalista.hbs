{{#extend "css"}}
<link href="/assets/datatables.net-bs/css/dataTables.bootstrap.min.css" rel="stylesheet">
<link href="/assets/datatables.net-responsive-bs/css/responsive.bootstrap.min.css" rel="stylesheet">
{{/extend}}

<div class="right_col" role="main">
  <div class="">
    <div class="clearfix"></div>
    <div class="row">
      <div class="col-md-12 col-sm-12 col-xs-12">
        <div class="x_panel">
          <div class="x_title">
            <h2>Listado de Empresas</h2>
            <div class="clearfix"></div>
          </div>
          <div class="x_content">
            <table id="tblList" class="table table-striped table-bordered dt-responsive nowrap display" cellspacing="0" style="width:100%">
                <thead>
                    <tr>
                        <th></th>
                        <th>RUC</th>
                        <th>Empresa</th>
                        <th>Abreviado</th>
                        <th>Dirección</th>
                        <th>Teléfono</th>
                        <th>Móvil</th>
                        <th>Email</th>
                        <th>URL</th>
                        <th></th>
                    </tr>
                </thead>
                <tbody>
                </tbody>
            </table>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

{{#extend "js"}}
<script src="/assets/jquery.dataTables.min.js"></script>
<script src="/assets/dataTables.buttons.min.js"></script>
<script src="/assets/datatables.net-bs/js/dataTables.bootstrap.min.js"></script>
<script src="/assets/datatables.net-responsive/js/dataTables.responsive.min.js"></script>
<script src="/assets/datatables.net-responsive-bs/js/responsive.bootstrap.js"></script>
<script>
  $(document).ready(function() {
    var table = $('#tblList').DataTable({
      dom: 'Blfrtip',
      ajax: {
        url: "/api/empresa/list?count=100",
        type: 'GET'
      },
      buttons: [
        {
          text: "Nuevo",
          className: "btn btn-default",
          action: function (e, dt, node, config) {
              //alert( 'Button activated' );
              window.location = "/empresas/ver/0";
          }
        }
      ],
      columns: [
        { data: "IdEmpresa", visible: false },
        { data: 'RUC' },
        { data: 'Empresa' },
        { data: 'EmpresaAbrev' },
        { data: 'Direccion' },
        { data: 'Telefono' },
        { data: 'Movil' },
        { data: 'Email' },
        { data: 'URL' },
        {
          data: null,
          bSortable: false,
          render: function (o) { 
            return '<a id="edit" class="btn btn-default submit" title="Editar" href="/empresas/ver/' + o.IdEmpresa + '"><i class="glyphicon glyphicon-pencil"></i></a>'; 
          }
        }
      ]
    });
  }); 
  /*$('#tblList tbody').on( 'click', 'a', function () {
    var data = table.row($(this).parents('tr')).data();
    console.log(data[0]);
  });*/
</script>
{{/extend}}
